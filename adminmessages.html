<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SECURE_COMMS // ADMIN_ACCESS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

    <style>
        :root {
            --neon-blue: #00f3ff;
            --neon-pink: #bc13fe;
            --neon-green: #00ff9d;
            --bg-dark: #020202;
            --panel-bg: rgba(0, 0, 0, 0.9);
            --border-color: rgba(0, 243, 255, 0.3);
            --accent-color: var(--neon-pink);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Courier New', monospace;
            background: var(--bg-dark);
            color: #fff;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden; /* Hide default body scroll */
            position: relative;
        }

        /* --- DASHBOARD BACKGROUND & EFFECTS --- */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* Scanning/Grid Effect */
            background: 
                linear-gradient(90deg, var(--border-color) 1px, transparent 1px) 0 0 / 50px 50px,
                linear-gradient(180deg, var(--border-color) 1px, transparent 1px) 0 0 / 50px 50px,
                linear-gradient(rgba(0, 243, 255, 0.05) 50%, transparent 50%) 0 0 / 100% 4px;
            pointer-events: none;
            z-index: 1;
        }
        
        /* Simulated CRT Scanline Effect (subtle) */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.1),
                rgba(var(--neon-blue), 0.2) 1px,
                transparent 2px
            );
            pointer-events: none;
            opacity: 0.15;
            z-index: 2;
        }

        /* --- LAYOUT AND PANELS --- */
        .header {
            width: 100%;
            padding: 15px 0;
            background: rgba(0, 0, 0, 0.95);
            border-bottom: 3px solid var(--neon-pink);
            text-align: center;
            box-shadow: 0 0 20px rgba(188, 19, 254, 0.6);
            color: var(--neon-green);
            font-size: 1.8rem;
            letter-spacing: 5px;
            z-index: 100;
        }

        .dashboard-layout {
            display: grid;
            grid-template-columns: 1fr 3fr; /* Status on left, Log on right */
            width: 95%;
            max-width: 1200px;
            height: 85vh;
            margin-top: 20px;
            gap: 20px;
            z-index: 10;
        }

        .side-panel {
            background: var(--panel-bg);
            border: 1px solid var(--neon-blue);
            padding: 15px;
            box-shadow: 0 0 10px rgba(0, 243, 255, 0.4);
            overflow-y: hidden;
        }

        .log-panel {
            grid-column: 2 / 3;
        }

        .panel-title {
            color: var(--neon-pink);
            font-size: 1.2rem;
            border-bottom: 2px solid var(--neon-green);
            padding-bottom: 10px;
            margin-bottom: 15px;
            letter-spacing: 2px;
            text-shadow: 0 0 5px var(--neon-green);
        }

        /* --- STATUS PANEL CONTENT --- */
        .system-status p {
            font-size: 0.9rem;
            margin-bottom: 10px;
            border-left: 3px solid var(--neon-blue);
            padding-left: 8px;
        }
        .system-status .status-ok { color: var(--neon-green); }
        .system-status .status-warn { color: yellow; }
        .system-status .status-err { color: red; }

        /* --- MESSAGE LOG (Container) --- */
        .container {
            height: calc(100% - 40px); /* Adjust height for title */
            overflow-y: auto;
            padding: 5px;
            /* Removed the outer border since we have the panel border */
        }
        
        .status-line {
            color: var(--neon-blue);
            font-size: 0.9rem;
            margin-bottom: 15px;
            border-bottom: 1px dashed var(--neon-blue);
            padding-bottom: 5px;
            animation: flicker 1.5s infinite alternate;
        }

        /* --- MESSAGE CARD STYLING (The Log Entries) --- */
        .msg-card {
            background: rgba(0, 0, 0, 0.6);
            border-left: 4px solid var(--accent-color);
            margin-bottom: 12px;
            padding: 10px 15px;
            font-size: 0.8rem;
            /* Added a subtle glow on hover */
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .msg-card:hover {
            background: rgba(0, 243, 255, 0.05);
            border-left-color: var(--neon-green);
            box-shadow: 0 0 15px rgba(0, 243, 255, 0.5);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            color: var(--neon-blue);
            font-weight: bold;
            margin-bottom: 5px;
        }

        .sender-name {
            color: var(--neon-green);
            font-size: 1rem;
            font-weight: bold;
            margin-bottom: 5px;
            text-shadow: 0 0 3px var(--neon-green);
        }

        .msg-body {
            color: #d0d0d0;
            white-space: pre-wrap;
            margin-bottom: 5px;
            border-top: 1px dashed rgba(255, 255, 255, 0.1);
            padding-top: 5px;
        }

        .timestamp {
            color: var(--accent-color);
            font-size: 0.7rem;
            text-align: right;
            margin-top: 5px;
        }

        /* --- ANIMATIONS --- */
        @keyframes flicker {
            0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
                text-shadow: 
                    -0.2rem -0.2rem 1rem #fff,
                    0.2rem 0.2rem 1rem var(--neon-blue);
                opacity: 0.9;
            }
            20%, 24%, 55% {        
                text-shadow: none;
                opacity: 0.5;
            }
        }

        /* Scrollbar Styling */
        .container::-webkit-scrollbar { width: 8px; }
        .container::-webkit-scrollbar-track { background: var(--bg-dark); }
        .container::-webkit-scrollbar-thumb { background: var(--neon-blue); border-radius: 4px; }
        .container::-webkit-scrollbar-thumb:hover { background: var(--neon-pink); }

        /* Mobile adjustments */
        @media (max-width: 800px) {
            .dashboard-layout {
                grid-template-columns: 1fr;
                height: auto;
            }
            .side-panel {
                height: 200px;
                overflow-y: auto;
            }
            .log-panel {
                grid-column: 1 / 2;
                height: 60vh;
            }
        }
    </style>
</head>
<body>

    <div class="header">
        <i class="fas fa-terminal"></i> SECURE_COMMS // ADMIN_ACCESS
    </div>

    <div class="dashboard-layout">
        
        <div class="side-panel">
            <div class="panel-title"><i class="fas fa-cogs"></i> SYSTEM STATUS</div>
            <div class="system-status">
                <p class="status-ok">NODE_SERVER: Online</p>
                <p class="status-ok">FIREBASE_RTDB: Connected</p>
                <p class="status-warn">DATA_LOG_SIZE: 98% Capacity</p>
                <p class="status-err">ANOMALY_DETECTION: Offline</p>
                <p class="status-ok">NETWORK_PING: 47ms</p>
            </div>
            
            <div class="panel-title" style="margin-top: 30px;"><i class="fas fa-chart-line"></i> DATA STATS</div>
            <div class="system-status">
                 <p style="border-left: 3px solid var(--neon-green); color: #fff;">MSGS_RECEIVED: <span id="msgCount">0</span></p>
                 <p style="border-left: 3px solid var(--neon-pink); color: #fff;">ANONYMOUS_AGENTS: <span id="anonCount">0</span></p>
            </div>
        </div>

        <div class="side-panel log-panel">
            <div class="panel-title"><i class="fas fa-scroll"></i> INCOMING DATA LOG</div>
            <div class="container">
                <div class="status-line">
                    > STATUS: Real-time data stream established. Awaiting input...
                </div>
                <div id="messageList">
                    <div style="text-align:center; color: #aaa; margin-top: 50px;">Awaiting initial data stream...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- FIREBASE CONFIGURATION ---
        /* ================================================================================
        üõëüõëüõë CRITICAL: REPLACE PLACEHOLDERS üõëüõëüõë
        
        1. CONFIGURATION: Replace these placeholder values with 
           the exact configuration object from your Firebase project settings.
        */
        const firebaseConfig = {
            apiKey: "AIzaSyBA-aIzlTIT34BGEEo8_n2bbSgdl_-_A1Q", // ‚¨ÖÔ∏è REPLACE THIS KEY
            authDomain: "aboutme-5eb1f.firebaseapp.com",
            projectId: "aboutme-5eb1f",
            storageBucket: "aboutme-5eb1f.firebasestorage.app",
            messagingSenderId: "464790179846",
            appId: "1:464790179846:web:9e8b509c948be5d324b387",
            measurementId: "G-0JBZS17FNS"
        };
        
        let db;
        let messageCounter = 0;
        let anonymousCounter = 0;

        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.database();
            loadMessages();
        } catch (e) {
            console.error(e);
            document.getElementById('messageList').innerHTML = `<div style="color:red; font-weight: bold;">> CONNECTION ERROR: Firebase initialization failed. Check console for details.</div>`;
        }

        // --- MESSAGE READING LOGIC ---
        function loadMessages() {
            const list = document.getElementById('messageList');
            const msgCountElement = document.getElementById('msgCount');
            const anonCountElement = document.getElementById('anonCount');
            list.innerHTML = ''; // Clear initial message

            // Listens for 'child_added' event on the 'messages' node, ordered by timestamp
            db.ref('messages').orderByChild('timestamp').on('child_added', (snapshot) => {
                const msg = snapshot.val();
                
                // Update stats
                messageCounter++;
                if ((msg.sender || "").toUpperCase() === "ANONYMOUS_AGENT") {
                    anonymousCounter++;
                }
                msgCountElement.textContent = messageCounter;
                anonCountElement.textContent = anonymousCounter;
                
                // Creates and prepends the new message card
                createMessageCard(msg, list);
            }, (error) => {
                 console.error("Firebase Read Error:", error);
                 list.innerHTML = `<div style="color:red; font-weight: bold;">> FIREBASE READ ERROR: ${error.message}. Check Security Rules.</div>`;
            });
        }

        function createMessageCard(msg, list) {
            const card = document.createElement('div');
            card.className = 'msg-card';
            
            // Format timestamp
            const date = new Date(msg.timestamp || Date.now());
            const timeStr = date.toLocaleTimeString() + ' ' + date.toLocaleDateString();
            const senderName = escapeHtml(msg.sender) || "ANONYMOUS_AGENT";

            card.innerHTML = `
                <div class="card-header">
                    <span><i class="fas fa-hashtag"></i> LOG_ID: ${Math.random().toString(36).substr(2, 6).toUpperCase()}</span>
                    <span><i class="fas fa-shield-alt"></i> STATUS: ${senderName.toUpperCase() === "ANONYMOUS_AGENT" ? 'ANON' : 'VERIFIED'}</span>
                </div>
                <div class="sender-name">AGENT: ${senderName}</div>
                <div class="msg-body">${escapeHtml(msg.message)}</div>
                <div class="timestamp">> RCVD: ${timeStr}</div>
            `;
            
            // Prepend the new card so the newest message is at the top
            list.prepend(card);
        }

        // Basic HTML escape to prevent XSS (Good practice!)
        function escapeHtml(text) {
            if (!text) return "";
            return text
                .replace(/&/g, "&amp;")
                .replace(/</g, "&lt;")
                .replace(/>/g, "&gt;")
                .replace(/"/g, "&quot;")
                .replace(/'/g, "&#039;");
        }
    </script>
</body>
</html>